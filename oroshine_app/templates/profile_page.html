{% load static %}
<!DOCTYPE html>
<html lang="en">
  {% include "head_template.html" %}
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ title }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body{background:#f4f6f9;font-family:"Segoe UI",sans-serif;}
    .card{border-radius:.75rem;box-shadow:0 4px 15px rgba(0,0,0,.08);}
    .profile-header{background:linear-gradient(135deg,#4e73df,#1cc88a);color:#fff;text-align:center;padding:2rem 1rem;}
    .profile-header h2{font-weight:700;}
    .profile-avatar svg{width:120px;height:120px;border-radius:50%;border:4px solid #fff;box-shadow:0 4px 12px rgba(0,0,0,.25);background:#fff;padding:5px;}
    .section-title{font-weight:600;color:#4e73df;margin-bottom:1rem;}
    .info-card{background:#fff;padding:1.5rem;border-radius:.5rem;margin-bottom:1.5rem;}
    .profile-info dt{color:#6c757d;font-weight:500;}
    .table thead{background:#4e73df;color:#fff;}
    .table-striped>tbody>tr:nth-of-type(odd){background:#f8f9fc;}
    .no-data{text-align:center;color:#6c757d;font-style:italic;}
    .badge{font-size:.85rem;}
  </style>
</head>
<body>
  {% include "header.html" %}
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-10 col-md-12">

        <!-- Profile Card -->
        <div class="card mb-4 overflow-hidden">
          <div class="profile-header">
            <div class="profile-avatar mb-3">
              {% if profile.photo %}
                <img src="{{ profile.photo.url }}" class="rounded-circle border border-4 border-white shadow" width="120" height="120" alt="Profile">
              {% else %}
                {% if profile.gender == "M" %}
                  <!-- Male SVG Avatar -->
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="none">
                    <circle cx="32" cy="32" r="30" fill="#dbeafe"/>
                    <circle cx="32" cy="24" r="12" fill="#2563eb"/>
                    <path d="M10 54c4-10 14-16 22-16s18 6 22 16" fill="#2563eb"/>
                  </svg>
                {% elif profile.gender == "F" %}
                  <!-- Female SVG Avatar -->
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="none">
                    <circle cx="32" cy="32" r="30" fill="#fce7f3"/>
                    <circle cx="32" cy="22" r="11" fill="#db2777"/>
                    <path d="M12 54c3-9 13-14 20-14s17 5 20 14" fill="#db2777"/>
                  </svg>
                {% else %}
                  <!-- Default Neutral SVG Avatar -->
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="none">
                    <circle cx="32" cy="32" r="30" fill="#e5e7eb"/>
                    <circle cx="32" cy="24" r="12" fill="#6b7280"/>
                    <path d="M10 54c4-10 14-16 22-16s18 6 22 16" fill="#6b7280"/>
                  </svg>
                {% endif %}
              {% endif %}
            </div>
            <h2>{{ user.first_name }} {{ user.last_name }}</h2>
            <p class="mb-0">{{ user.email }}</p>
          </div>
          <div class="card-body p-4">

            <!-- Account Info -->
            <div class="info-card">
              <h5 class="section-title">Account Information</h5>
              <dl class="row profile-info">
                <dt class="col-sm-4">Username</dt><dd class="col-sm-8">{{ user.username }}</dd>
                <dt class="col-sm-4">Email</dt><dd class="col-sm-8">{{ user.email }}</dd>
                <dt class="col-sm-4">Active</dt><dd class="col-sm-8">{{ user.is_active }}</dd>
                <dt class="col-sm-4">Last Login</dt><dd class="col-sm-8">{{ user.last_login|default:"-" }}</dd>
              </dl>
            </div>

            <!-- Personal Info -->
            <div class="info-card">
              <h5 class="section-title">Personal Information</h5>
              <dl class="row profile-info">
                <dt class="col-sm-4">Date of Birth</dt><dd class="col-sm-8">{{ profile.dob|default:"Not provided" }}</dd>
                <dt class="col-sm-4">Gender</dt><dd class="col-sm-8">{{ profile.get_gender_display|default:"Not provided" }}</dd>
                <dt class="col-sm-4">Address</dt><dd class="col-sm-8">{{ profile.address|default:"Not provided" }}</dd>
                <dt class="col-sm-4">Phone Number</dt><dd class="col-sm-8">{{ profile.user.phone_number|default:"Not provided" }}</dd>
                <dt class="col-sm-4">Emergency Contact</dt>
                <dd class="col-sm-8">{{ profile.emergency_contact_name|default:"-" }} ({{ profile.emergency_contact_number|default:"Not provided" }})</dd>
                <dt class="col-sm-4">Blood Group</dt><dd class="col-sm-8">{{ profile.blood_group|default:"Not provided" }}</dd>
                <dt class="col-sm-4">Allergies</dt><dd class="col-sm-8">{{ profile.allergies|default:"None" }}</dd>
                <dt class="col-sm-4">Medical History</dt><dd class="col-sm-8">{{ profile.medical_history|default:"Not provided" }}</dd>
                <dt class="col-sm-4">Bio</dt><dd class="col-sm-8">{{ profile.bio|default:"Not provided" }}</dd>
              </dl>
            </div>

            <div class="info-card text-end">
              <small class="text-muted">Created At: {{ profile.created_at|date:"M d, Y H:i" }} | Last Updated: {{ profile.updated_at|date:"M d, Y H:i" }}</small>
            </div>
          </div>
        </div>

        <!-- Appointments -->
        <div class="card overflow-hidden">
          <div class="card-body p-4">
            <h5 class="section-title mb-4">My Appointments</h5>
            {% if my_appointments %}
            <div class="table-responsive">
              <table class="table table-striped align-middle">
                <thead>
                  <tr>
                    <th>#</th><th>Date</th><th>Time</th><th>Description</th><th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  {% for appointment in my_appointments %}
                  <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ appointment.date|date:"M d, Y" }}</td>
                    <td>{{ appointment.time|time:"H:i" }}</td>
                    <td>{{ appointment.description|default:"-" }}</td>
                    <td>
                      {% if appointment.status == "Completed" %}
                        <span class="badge bg-success">Completed</span>
                      {% elif appointment.status == "Cancelled" %}
                        <span class="badge bg-danger">Cancelled</span>
                      {% else %}
                        <span class="badge bg-warning text-dark">{{ appointment.status|default:"Pending" }}</span>
                      {% endif %}
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
            {% else %}
            <p class="no-data">You have no appointments yet.</p>
            {% endif %}
          </div>
        </div>

      </div>
    </div>
  </div>
  {% include "footer.html" %}
</body>
</html>
